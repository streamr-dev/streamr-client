{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 33ce94fadfb06747b70a","webpack:///./node_modules/eventemitter3/index.js","webpack:///./node_modules/debug/src/browser.js","webpack:///./src/Protocol.js","webpack:///./src/shims/ws.js","webpack:///./src/index.js","webpack:///./src/StreamrClient.js","webpack:///./node_modules/process/browser.js","webpack:///./node_modules/debug/src/debug.js","webpack:///./node_modules/ms/index.js","webpack:///./src/Subscription.js","webpack:///./src/Connection.js"],"names":["decodeBrowserWrapper","decodeMessage","createSubscribeRequest","isByeMessage","CONTENT_TYPE_JSON","FIELDS_BY_PROTOCOL_VERSION","MESSAGE_TYPES","BYE_KEY","rawMsg","jsonMsg","JSON","parse","version","type","subId","msg","message","undefined","result","fields","i","length","contentType","stream","resendOptions","req","Object","keys","forEach","key","WebSocket","window","require","module","exports","StreamrClient","options","url","autoConnect","autoDisconnect","authKey","subsByStream","subById","connection","connected","assign","sub","id","streamId","push","filter","it","callback","legacyOptions","partition","on","from","to","_requestResend","resend_from","resend_to","unsubscribe","_addSubscription","_resendAndSubscribe","connect","disconnecting","isSubscribed","unsubscribing","_requestUnsubscribe","_removeSubscription","emit","_checkAutoDisconnect","l","slice","connecting","subs","handleMessage","response","error","handleError","_subscribing","resending","disconnect","unsubscribeAll","subscribing","_requestSubscribe","once","hasResendOptions","subscribedSubs","send","setTimeout","getEffectiveResendOptions","match","request","streamPartition","generateSubscriptionId","toString","Subscription","queue","subscribed","lastReceivedOffset","resendOptionCount","resend_all","resend_last","resend_from_time","stringify","getTime","checkQueue","isResend","content","offset","previousOffset","originalQueue","hasReceivedMessages","Connection","socket","binaryType","onopen","onclose","onmessage","messageEvent","decoded","data","close"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;AC7DA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,EAAE;AACb,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,aAAa;AACxB,WAAW,gBAAgB;AAC3B,WAAW,SAAS;AACpB,WAAW,EAAE;AACb,WAAW,QAAQ;AACnB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,aAAa;AACxB,WAAW,gBAAgB;AAC3B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,gBAAgB;AAC3B,aAAa,MAAM;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,yDAAyD,OAAO;AAChE;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,gBAAgB;AAC3B,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,gBAAgB;AAC3B,aAAa,QAAQ;AACrB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,yCAAyC,SAAS;AAClD;AACA;;AAEA;AACA,GAAG;AACH;AACA;;AAEA,eAAe,YAAY;AAC3B;;AAEA;AACA,2DAA2D;AAC3D,+DAA+D;AAC/D,mEAAmE;AACnE,uEAAuE;AACvE;AACA,0DAA0D,SAAS;AACnE;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,gBAAgB;AAC3B,WAAW,SAAS;AACpB,WAAW,EAAE;AACb,aAAa,aAAa;AAC1B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,gBAAgB;AAC3B,WAAW,SAAS;AACpB,WAAW,EAAE;AACb,aAAa,aAAa;AAC1B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,gBAAgB;AAC3B,WAAW,SAAS;AACpB,WAAW,EAAE;AACb,WAAW,QAAQ;AACnB,aAAa,aAAa;AAC1B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,2DAA2D,YAAY;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,gBAAgB;AAC3B,aAAa,aAAa;AAC1B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;;;AC/UA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;;;;;;;QC3LgBA,oB,GAAAA,oB;QAcAC,a,GAAAA,a;QA2BAC,sB,GAAAA,sB;QAUAC,Y,GAAAA,Y;AA1DhB,IAAMC,oBAAoB,EAA1B;AACA,IAAMC,6BAA8B;AAChC,UAAM,CAAC,SAAD,EAAY,UAAZ,EAAwB,iBAAxB,EAA2C,WAA3C,EAAwD,KAAxD,EAA+D,QAA/D,EAAyE,gBAAzE,EAA2F,aAA3F,EAA0G,SAA1G;AAD0B,CAApC;AAGA,IAAMC,gBAAgB,CAAC,GAAD,EAAM,GAAN,EAAW,YAAX,EAAyB,cAAzB,EAAyC,WAAzC,EAAsD,QAAtD,EAAgE,WAAhE,CAAtB;AACA,IAAMC,UAAU,MAAhB;;AAEO,SAASP,oBAAT,CAA8BQ,MAA9B,EAAsC;AACzC,QAAIC,UAAUC,KAAKC,KAAL,CAAWH,MAAX,CAAd;AACA,QAAII,UAAUH,QAAQ,CAAR,CAAd;AACA,QAAIG,YAAY,CAAhB,EAAmB;AACf,cAAM,8BAA4BA,OAAlC;AACH;;AAED,WAAO;AACHC,cAAMP,cAAcG,QAAQ,CAAR,CAAd,CADH;AAEHK,eAAOL,QAAQ,CAAR,CAFJ;AAGHM,aAAKN,QAAQ,CAAR;AAHF,KAAP;AAKH;;AAEM,SAASR,aAAT,CAAuBY,IAAvB,EAA6BG,OAA7B,EAAsC;AACzC,QAAIH,SAAS,GAAT,IAAgBA,SAAS,GAA7B,EAAkC;AAC9B,YAAIR,2BAA2BW,QAAQ,CAAR,CAA3B,MAA2CC,SAA/C,EAA0D;AACtD,kBAAM,0BAA0BD,QAAQ,CAAR,CAAhC;AACH;AACD,YAAIE,SAAS,EAAb;AACA,YAAIC,SAASd,2BAA2BW,QAAQ,CAAR,CAA3B,CAAb;;AAEA,aAAK,IAAII,IAAI,CAAb,EAAgBA,IAAIJ,QAAQK,MAA5B,EAAoCD,GAApC,EAAyC;;AAErC;AACA,gBAAID,OAAOC,CAAP,MAAc,SAAlB,EAA6B;AACzB,oBAAIF,OAAOI,WAAP,KAAuBlB,iBAA3B,EAA8C;AAC1CY,4BAAQI,CAAR,IAAaV,KAAKC,KAAL,CAAWK,QAAQI,CAAR,CAAX,CAAb;AACH,iBAFD,MAEO;AACH,0BAAM,2BAA2BF,OAAOI,WAAxC;AACH;AACJ;;AAEDJ,mBAAOC,OAAOC,CAAP,CAAP,IAAoBJ,QAAQI,CAAR,CAApB;AACH;AACD,eAAOF,MAAP;AACH,KArBD,MAqBO;AACH,eAAOF,OAAP;AACH;AACJ;;AAEM,SAASd,sBAAT,CAAgCqB,MAAhC,EAAwCC,aAAxC,EAAuD;AAC1D,QAAIC,MAAM;AACNF,gBAAQA;AADF,KAAV;AAGAG,WAAOC,IAAP,CAAYH,aAAZ,EAA2BI,OAA3B,CAAmC,UAASC,GAAT,EAAc;AAC7CJ,YAAII,GAAJ,IAAWL,cAAcK,GAAd,CAAX;AACH,KAFD;AAGA,WAAOJ,GAAP;AACH;;AAEM,SAAStB,YAAT,CAAsBa,OAAtB,EAA+B;AAClC,WAAO,CAAC,CAACA,QAAQT,OAAR,CAAT;AACH,C;;;;;;;;;AC5DD,IAAMuB,YAAY,OAAOC,MAAP,KAAkB,WAAlB,GAAgCA,OAAOD,SAAvC,GAAmD,mBAAAE,CAAQ,CAAR,CAArE;AACAC,OAAOC,OAAP,GAAiBJ,SAAjB,C;;;;;;;;;;;;;ACDA;;;;;;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;ACHA;;;;AACA;;;;AAEA;;;;AACA;;;;;;;;;;;;IAEqBK,a;;;AAEjB,2BAAYC,OAAZ,EAAqB;AAAA;;AAGjB;AAHiB;;AAIjB,cAAKA,OAAL,GAAe;AACX;AACAC,iBAAK,iCAFM;AAGX;AACAC,yBAAa,IAJF;AAKX;AACAC,4BAAgB,IANL;AAOXC,qBAAS;AAPE,SAAf;AASA,cAAKC,YAAL,GAAoB,EAApB;AACA,cAAKC,OAAL,GAAe,EAAf;;AAEA,cAAKC,UAAL,GAAkB,IAAlB;AACA,cAAKC,SAAL,GAAiB,KAAjB;;AAEAlB,eAAOmB,MAAP,CAAc,MAAKT,OAAnB,EAA4BA,WAAW,EAAvC;AAnBiB;AAoBpB;;;;yCAEgBU,G,EAAK;AAClB,iBAAKJ,OAAL,CAAaI,IAAIC,EAAjB,IAAuBD,GAAvB;;AAEA,gBAAI,CAAC,KAAKL,YAAL,CAAkBK,IAAIE,QAAtB,CAAL,EAAsC;AAClC,qBAAKP,YAAL,CAAkBK,IAAIE,QAAtB,IAAkC,CAACF,GAAD,CAAlC;AACH,aAFD,MAEO;AACH,qBAAKL,YAAL,CAAkBK,IAAIE,QAAtB,EAAgCC,IAAhC,CAAqCH,GAArC;AACH;AACJ;;;4CAEmBA,G,EAAK;AACrB,mBAAO,KAAKJ,OAAL,CAAaI,IAAIC,EAAjB,CAAP;;AAEA,gBAAI,KAAKN,YAAL,CAAkBK,IAAIE,QAAtB,CAAJ,EAAqC;AACjC,qBAAKP,YAAL,CAAkBK,IAAIE,QAAtB,IAAkC,KAAKP,YAAL,CAAkBK,IAAIE,QAAtB,EAAgCE,MAAhC,CAAuC,UAACC,EAAD,EAAQ;AAC7E,2BAAOA,OAAOL,GAAd;AACH,iBAFiC,CAAlC;;AAIA,oBAAI,KAAKL,YAAL,CAAkBK,IAAIE,QAAtB,EAAgC3B,MAAhC,KAA2C,CAA/C,EAAkD;AAC9C,2BAAO,KAAKoB,YAAL,CAAkBK,IAAIE,QAAtB,CAAP;AACH;AACJ;AACJ;;;yCAEgBA,Q,EAAU;AACvB,mBAAO,KAAKP,YAAL,CAAkBO,QAAlB,KAA+B,EAAtC;AACH;;;kCAESZ,O,EAASgB,Q,EAAUC,a,EAAe;AAAA;;AACxC,gBAAI,CAACjB,OAAL,EAAc;AACV,sBAAM,iEAAN;AACH,aAFD,MAEO,IAAI,CAACgB,QAAL,EAAe;AAClB,sBAAM,qDAAN;AACH;;AAED;AACA,gBAAI,OAAOhB,OAAP,KAAmB,QAAvB,EAAiC;AAC7BA,0BAAU;AACNb,4BAAQa;AADF,iBAAV;AAGH,aAJD,MAIO,IAAI,QAAOA,OAAP,yCAAOA,OAAP,OAAmB,QAAvB,EAAiC;AACpC,sBAAM,sCAAN;AACH;;AAED;AACAV,mBAAOmB,MAAP,CAAcT,OAAd,EAAuBiB,aAAvB;;AAEA,gBAAI,CAACjB,QAAQb,MAAb,EAAqB;AACjB,sBAAM,2DAAN;AACH;;AAED;AACA,gBAAIuB,MAAM,2BAAiBV,QAAQb,MAAzB,EAAiCa,QAAQkB,SAAR,IAAqB,CAAtD,EAAyDlB,QAAQI,OAAR,IAAmB,KAAKJ,OAAL,CAAaI,OAAzF,EAAkGY,QAAlG,EAA4GhB,OAA5G,CAAV;AACAU,gBAAIS,EAAJ,CAAO,KAAP,EAAc,UAACC,IAAD,EAAOC,EAAP,EAAc;AACxB,uBAAKC,cAAL,CAAoBZ,GAApB,EAAyB;AACrBa,iCAAaH,IADQ,EACFI,WAAWH;AADT,iBAAzB;AAGH,aAJD;AAKAX,gBAAIS,EAAJ,CAAO,MAAP,EAAe,YAAM;AACjB,qCAAM,uBAAN,EAA+BT,IAAIC,EAAnC;AACA,uBAAKc,WAAL,CAAiBf,GAAjB;AACH,aAHD;;AAKA;AACA,iBAAKgB,gBAAL,CAAsBhB,GAAtB;;AAEA;AACA,gBAAI,KAAKF,SAAT,EAAoB;AAChB,qBAAKmB,mBAAL,CAAyBjB,GAAzB;AACH,aAFD,MAEO,IAAI,KAAKV,OAAL,CAAaE,WAAjB,EAA8B;AACjC,qBAAK0B,OAAL;AACH;;AAED,mBAAOlB,GAAP;AACH;;;oCAEWA,G,EAAK;AACb,gBAAI,CAACA,GAAD,IAAQ,CAACA,IAAIE,QAAjB,EAA2B;AACvB,sBAAM,gEAAN;AACH;;AAED;AACA,gBAAI,KAAKP,YAAL,CAAkBK,IAAIE,QAAtB,MAAoC/B,SAApC,IAAiD,KAAKwB,YAAL,CAAkBK,IAAIE,QAAtB,EAAgC3B,MAAhC,KAA2C,CAA5F,IAAiG,KAAKuB,SAAtG,IAAmH,CAAC,KAAKqB,aAAzH,IAA0InB,IAAIoB,YAAJ,EAA1I,IAAgK,CAACpB,IAAIqB,aAAzK,EAAwL;AACpLrB,oBAAIqB,aAAJ,GAAoB,IAApB;AACA,qBAAKC,mBAAL,CAAyBtB,IAAIE,QAA7B;AACH,aAHD,MAGO,IAAI,CAACF,IAAIqB,aAAT,EAAwB;AAC3B;AACA,qBAAKE,mBAAL,CAAyBvB,GAAzB;AACAA,oBAAIwB,IAAJ,CAAS,cAAT;AACA,qBAAKC,oBAAL;AACH;AACJ;;;uCAEcvB,Q,EAAU;AAAA;;AACrB,gBAAI,CAACA,QAAL,EAAe;AACX,sBAAM,0CAAN;AACH,aAFD,MAEO,IAAI,OAAOA,QAAP,KAAoB,QAAxB,EAAkC;AACrC,sBAAM,0CAAN;AACH;;AAED,gBAAI,KAAKP,YAAL,CAAkBO,QAAlB,CAAJ,EAAiC;AAC7B;AACA,oBAAIwB,IAAI,KAAK/B,YAAL,CAAkBO,QAAlB,EAA4ByB,KAA5B,EAAR;AACAD,kBAAE5C,OAAF,CAAU,UAACkB,GAAD,EAAS;AACf,2BAAKe,WAAL,CAAiBf,GAAjB;AACH,iBAFD;AAGH;AACJ;;;sCAEa;AACV,mBAAO,KAAKF,SAAZ;AACH;;;oCAEW;AACR,mBAAO,KAAKoB,OAAL,CAAa,IAAb,CAAP;AACH;;;kCAES;AAAA;;AACN,gBAAI,KAAKpB,SAAT,EAAoB;AAChB,qCAAM,4DAAN;AACA;AACH,aAHD,MAGO,IAAI,KAAK8B,UAAT,EAAqB;AACxB,qCAAM,qDAAN;AACA;AACH;;AAED,iCAAM,kBAAN,EAA0B,KAAKtC,OAAL,CAAaC,GAAvC;AACA,iBAAKqC,UAAL,GAAkB,IAAlB;AACA,iBAAKT,aAAL,GAAqB,KAArB;;AAEA,iBAAKtB,UAAL,GAAkB,yBAAe,KAAKP,OAApB,CAAlB;;AAEA;AACA,iBAAKO,UAAL,CAAgBY,EAAhB,CAAmB,GAAnB,EAAwB,UAACxC,GAAD,EAAS;AAC7B;AACA;AACA,oBAAIiC,WAAWjC,IAAIiC,QAAnB;AACA,oBAAI2B,OAAO,OAAKlC,YAAL,CAAkBO,QAAlB,CAAX;AACA,oBAAI2B,IAAJ,EAAU;AACN,yBAAK,IAAIvD,IAAI,CAAb,EAAgBA,IAAIuD,KAAKtD,MAAzB,EAAiCD,GAAjC,EAAsC;AAClCuD,6BAAKvD,CAAL,EAAQwD,aAAR,CAAsB7D,GAAtB,EAA2B,KAA3B;AACH;AACJ,iBAJD,MAIO;AACH,yCAAM,6DAAN,EAAqEiC,QAArE;AACH;AACJ,aAZD;;AAcA;AACA,iBAAKL,UAAL,CAAgBY,EAAhB,CAAmB,GAAnB,EAAwB,UAACxC,GAAD,EAAM+B,GAAN,EAAc;AAClC,oBAAIA,QAAQ7B,SAAR,IAAqB,OAAKyB,OAAL,CAAaI,GAAb,MAAsB7B,SAA/C,EAA0D;AACtD,2BAAKyB,OAAL,CAAaI,GAAb,EAAkB8B,aAAlB,CAAgC7D,GAAhC,EAAqC,IAArC;AACH,iBAFD,MAEO;AACH,yCAAM,sDAAN,EAA8DA,IAAIiC,QAAlE,EAA4EF,GAA5E;AACH;AACJ,aAND;;AAQA,iBAAKH,UAAL,CAAgBY,EAAhB,CAAmB,YAAnB,EAAiC,UAACsB,QAAD,EAAc;AAC3C,oBAAIA,SAASC,KAAb,EAAoB;AAChB,2BAAKC,WAAL,CAAiB,0BAA0BF,SAAStD,MAAnC,GAA4C,IAA5C,GAAmDsD,SAASC,KAA7E;AACH,iBAFD,MAEO;AACH,wBAAIH,OAAO,OAAKlC,YAAL,CAAkBoC,SAAStD,MAA3B,CAAX;AACA,2BAAOoD,KAAKK,YAAZ;;AAEA,yCAAM,uBAAN,EAA+BH,QAA/B;;AAEA;AACAF,yBAAKzB,MAAL,CAAY,UAACJ,GAAD,EAAS;AACjB,+BAAO,CAACA,IAAImC,SAAZ;AACH,qBAFD,EAGKrD,OAHL,CAGa,UAACkB,GAAD,EAAS;AACdA,4BAAIwB,IAAJ,CAAS,YAAT;AACH,qBALL;AAMH;AACJ,aAjBD;;AAmBA,iBAAK3B,UAAL,CAAgBY,EAAhB,CAAmB,cAAnB,EAAmC,UAACsB,QAAD,EAAc;AAC7C,qCAAM,yBAAN,EAAiCA,QAAjC;;AAEA,oBAAI,OAAKpC,YAAL,CAAkBoC,SAAStD,MAA3B,CAAJ,EAAwC;AACpC;AACA,wBAAIiD,IAAI,OAAK/B,YAAL,CAAkBoC,SAAStD,MAA3B,EAAmCkD,KAAnC,EAAR;AACAD,sBAAE5C,OAAF,CAAU,UAACkB,GAAD,EAAS;AACf,+BAAKuB,mBAAL,CAAyBvB,GAAzB;AACAA,4BAAIwB,IAAJ,CAAS,cAAT;AACH,qBAHD;AAIH;;AAED,uBAAKC,oBAAL;AACH,aAbD;;AAeA;AACA,iBAAK5B,UAAL,CAAgBY,EAAhB,CAAmB,WAAnB,EAAgC,UAACsB,QAAD,EAAc;AAC1C,oBAAI,OAAKnC,OAAL,CAAamC,SAAS/B,GAAtB,CAAJ,EAAgC;AAC5B,2BAAKJ,OAAL,CAAamC,SAAS/B,GAAtB,EAA2BwB,IAA3B,CAAgC,WAAhC,EAA6CO,QAA7C;AACH,iBAFD,MAEO;AACH,yCAAM,yCAAN,EAAiDA,SAAS/B,GAA1D;AACH;AACJ,aAND;;AAQA,iBAAKH,UAAL,CAAgBY,EAAhB,CAAmB,WAAnB,EAAgC,UAACsB,QAAD,EAAc;AAC1C,oBAAI,OAAKnC,OAAL,CAAamC,SAAS/B,GAAtB,CAAJ,EAAgC;AAC5B,2BAAKJ,OAAL,CAAamC,SAAS/B,GAAtB,EAA2BwB,IAA3B,CAAgC,WAAhC,EAA6CO,QAA7C;AACH,iBAFD,MAEO;AACH,yCAAM,yCAAN,EAAiDA,SAAS/B,GAA1D;AACH;AACJ,aAND;;AAQA,iBAAKH,UAAL,CAAgBY,EAAhB,CAAmB,QAAnB,EAA6B,UAACsB,QAAD,EAAc;AACvC,oBAAI,OAAKnC,OAAL,CAAamC,SAAS/B,GAAtB,CAAJ,EAAgC;AAC5B,2BAAKJ,OAAL,CAAamC,SAAS/B,GAAtB,EAA2BwB,IAA3B,CAAgC,QAAhC,EAA0CO,QAA1C;AACH,iBAFD,MAEO;AACH,yCAAM,yCAAN,EAAiDA,SAAS/B,GAA1D;AACH;AACJ,aAND;;AAQA;AACA,iBAAKH,UAAL,CAAgBY,EAAhB,CAAmB,WAAnB,EAAgC,YAAM;AAClC,qCAAM,YAAN;AACA,uBAAKX,SAAL,GAAiB,IAAjB;AACA,uBAAK8B,UAAL,GAAkB,KAAlB;AACA,uBAAKT,aAAL,GAAqB,KAArB;AACA,uBAAKK,IAAL,CAAU,WAAV;;AAEA5C,uBAAOC,IAAP,CAAY,OAAKc,YAAjB,EACKb,OADL,CACa,UAACoB,QAAD,EAAc;AACnB,wBAAI2B,OAAO,OAAKlC,YAAL,CAAkBO,QAAlB,CAAX;AACA2B,yBAAK/C,OAAL,CAAa,UAACkB,GAAD,EAAS;AAClB,4BAAI,CAACA,IAAIoB,YAAJ,EAAL,EAAyB;AACrB,mCAAKH,mBAAL,CAAyBjB,GAAzB;AACH;AACJ,qBAJD;AAKH,iBARL;AASH,aAhBD;;AAkBA,iBAAKH,UAAL,CAAgBY,EAAhB,CAAmB,cAAnB,EAAmC,YAAM;AACrC,qCAAM,eAAN;AACA,uBAAKX,SAAL,GAAiB,KAAjB;AACA,uBAAK8B,UAAL,GAAkB,KAAlB;AACA,uBAAKT,aAAL,GAAqB,KAArB;AACA,uBAAKK,IAAL,CAAU,cAAV;;AAEA5C,uBAAOC,IAAP,CAAY,OAAKc,YAAjB,EACKb,OADL,CACa,UAACoB,QAAD,EAAc;AACnB,wBAAI2B,OAAO,OAAKlC,YAAL,CAAkBO,QAAlB,CAAX;AACA,2BAAO2B,KAAKK,YAAZ;AACAL,yBAAK/C,OAAL,CAAa,UAACkB,GAAD,EAAS;AAClBA,4BAAIwB,IAAJ,CAAS,cAAT;AACH,qBAFD;AAGH,iBAPL;AAQH,aAfD;;AAiBA,iBAAK3B,UAAL,CAAgBqB,OAAhB,GAtIM,CAsIoB;AAC1B,mBAAO,KAAKvB,YAAZ;AACH;;;gCAEO;AACJ,iBAAKE,UAAL,CAAgBuC,UAAhB;AACH;;;qCAEY;AAAA;;AACT,iBAAKR,UAAL,GAAkB,KAAlB;AACA,iBAAKT,aAAL,GAAqB,IAArB;;AAEAvC,mBAAOC,IAAP,CAAY,KAAKc,YAAjB,EACKb,OADL,CACa,UAACoB,QAAD,EAAc;AACnB,uBAAKmC,cAAL,CAAoBnC,QAApB;AACH,aAHL;;AAKA,iBAAKL,UAAL,CAAgBuC,UAAhB;AACH;;;+CAEsB;AACnB;AACA,gBAAI,KAAK9C,OAAL,CAAaG,cAAb,IAA+Bb,OAAOC,IAAP,CAAY,KAAKc,YAAjB,EAA+BpB,MAA/B,KAA0C,CAA7E,EAAgF;AAC5E,qCAAM,gEAAN;AACA,qBAAK6D,UAAL;AACH;AACJ;;;4CAEmBpC,G,EAAK;AAAA;;AACrB,gBAAI,CAACA,IAAIsC,WAAL,IAAoB,CAACtC,IAAImC,SAA7B,EAAwC;AACpCnC,oBAAIsC,WAAJ,GAAkB,IAAlB;AACA,qBAAKC,iBAAL,CAAuBvC,GAAvB;;AAEA;AACAA,oBAAIwC,IAAJ,CAAS,YAAT,EAAuB,YAAM;AACzB,wBAAIxC,IAAIyC,gBAAJ,EAAJ,EAA4B;AACxB,+BAAK7B,cAAL,CAAoBZ,GAApB;AACH;AACJ,iBAJD;AAKH;AACJ;;;0CAEiBA,G,EAAK;AACnB,gBAAI6B,OAAO,KAAKlC,YAAL,CAAkBK,IAAIE,QAAtB,CAAX;;AAEA,gBAAIwC,iBAAiBb,KAAKzB,MAAL,CAAY,UAACC,EAAD,EAAQ;AACrC,uBAAOA,GAAGe,YAAH,EAAP;AACH,aAFoB,CAArB;;AAIA;AACA,gBAAI,CAACS,KAAKK,YAAN,IAAsBQ,eAAenE,MAAf,KAA0B,CAApD,EAAuD;AACnD,oBAAII,MAAMC,OAAOmB,MAAP,CAAc,EAAd,EAAkBC,IAAIV,OAAtB,EAA+B;AACrCvB,0BAAM,WAD+B,EAClBU,QAAQuB,IAAIE,QADM,EACIR,SAASM,IAAIN;AADjB,iBAA/B,CAAV;AAGA,qCAAM,2CAAN,EAAmDf,GAAnD;AACAkD,qBAAKK,YAAL,GAAoB,IAApB;AACA,qBAAKrC,UAAL,CAAgB8C,IAAhB,CAAqBhE,GAArB;AACH,aAPD,MAOO,IAAI+D,eAAenE,MAAf,GAAwB,CAA5B,EAA+B;AAClC;AACA,qCAAM,gFAAN,EAAwFyB,IAAIE,QAA5F;;AAEA0C,2BAAW,YAAM;AACb5C,wBAAIwB,IAAJ,CAAS,YAAT;AACH,iBAFD,EAEG,CAFH;AAGH;AACJ;;;4CAEmBtB,Q,EAAU;AAC1B,iCAAM,gCAAN,EAAwCA,QAAxC;AACA,iBAAKL,UAAL,CAAgB8C,IAAhB,CAAqB;AACjB5E,sBAAM,aADW;AAEjBU,wBAAQyB;AAFS,aAArB;AAIH;;;uCAEcF,G,EAAKtB,a,EAAe;AAC/B;AACA,gBAAIY,UAAUV,OAAOmB,MAAP,CAAc,EAAd,EAAkBC,IAAI6C,yBAAJ,EAAlB,CAAd;AACA,gBAAInE,aAAJ,EAAmB;AACfE,uBAAOC,IAAP,CAAYS,OAAZ,EACKR,OADL,CACa,UAACC,GAAD,EAAS;AACd,wBAAIA,IAAI+D,KAAJ,CAAU,WAAV,CAAJ,EAA4B;AACxB,+BAAOxD,QAAQP,GAAR,CAAP;AACH;AACJ,iBALL;AAMH;;AAEDiB,gBAAImC,SAAJ,GAAgB,IAAhB;;AAEA,gBAAIY,UAAUnE,OAAOmB,MAAP,CAAc,EAAd,EAAkBT,OAAlB,EAA2BZ,aAA3B,EAA0C;AACpDX,sBAAM,QAD8C,EACpCU,QAAQuB,IAAIE,QADwB,EACdM,WAAWR,IAAIgD,eADD,EACkBtD,SAASM,IAAIN,OAD/B,EACwCM,KAAKA,IAAIC;AADjD,aAA1C,CAAd;AAGA,iCAAM,oBAAN,EAA4B8C,OAA5B;AACA,iBAAKlD,UAAL,CAAgB8C,IAAhB,CAAqBI,OAArB;AACH;;;oCAEW9E,G,EAAK;AACb,iCAAMA,GAAN;AACA,iBAAKuD,IAAL,CAAU,OAAV,EAAmBvD,GAAnB;AACH;;;;;;kBAtXgBoB,a;;;;;;;ACNrB;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,qCAAqC;;AAErC;AACA;AACA;;AAEA,2BAA2B;AAC3B;AACA;AACA;AACA,4BAA4B,UAAU;;;;;;;;ACtLtC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,YAAY;AACZ;AACA;;AAEA;AACA;;AAEA;AACA;AACA,cAAc;AACd;;AAEA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY;AACZ;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,iBAAiB;AACpC;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,aAAa,SAAS;AACtB,4BAA4B;AAC5B;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA,aAAa,8BAA8B;AAC3C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yCAAyC,SAAS;AAClD;AACA;AACA;AACA;AACA,yCAAyC,SAAS;AAClD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,MAAM;AACjB,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA;;;;;;;AChOA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,WAAW,OAAO;AAClB,YAAY,MAAM;AAClB,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA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","file":"streamr-client.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"streamr-client\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"streamr-client\"] = factory();\n\telse\n\t\troot[\"StreamrClient\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 33ce94fadfb06747b70a","'use strict';\n\nvar has = Object.prototype.hasOwnProperty\n  , prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n\n  var listener = new EE(fn, context || emitter, once)\n    , evt = prefix ? prefix + event : event;\n\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;\n  else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);\n  else emitter._events[evt] = [emitter._events[evt], listener];\n\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();\n  else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = []\n    , events\n    , name;\n\n  if (this._eventsCount === 0) return names;\n\n  for (name in (events = this._events)) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event\n    , handlers = this._events[evt];\n\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event\n    , listeners = this._events[evt];\n\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return false;\n\n  var listeners = this._events[evt]\n    , len = arguments.length\n    , args\n    , i;\n\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n\n    switch (len) {\n      case 1: return listeners.fn.call(listeners.context), true;\n      case 2: return listeners.fn.call(listeners.context, a1), true;\n      case 3: return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4: return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5: return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6: return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n\n    for (i = 1, args = new Array(len -1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length\n      , j;\n\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n\n      switch (len) {\n        case 1: listeners[i].fn.call(listeners[i].context); break;\n        case 2: listeners[i].fn.call(listeners[i].context, a1); break;\n        case 3: listeners[i].fn.call(listeners[i].context, a1, a2); break;\n        case 4: listeners[i].fn.call(listeners[i].context, a1, a2, a3); break;\n        default:\n          if (!args) for (j = 1, args = new Array(len -1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n\n  var listeners = this._events[evt];\n\n  if (listeners.fn) {\n    if (\n      listeners.fn === fn &&\n      (!once || listeners.once) &&\n      (!context || listeners.context === context)\n    ) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (\n        listeners[i].fn !== fn ||\n        (once && !listeners[i].once) ||\n        (context && listeners[i].context !== context)\n      ) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;\n    else clearEvent(this, evt);\n  }\n\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/eventemitter3/index.js\n// module id = 0\n// module chunks = 0","/**\n * This is the web browser implementation of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = require('./debug');\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = 'undefined' != typeof chrome\n               && 'undefined' != typeof chrome.storage\n                  ? chrome.storage.local\n                  : localstorage();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n  '#0000CC', '#0000FF', '#0033CC', '#0033FF', '#0066CC', '#0066FF', '#0099CC',\n  '#0099FF', '#00CC00', '#00CC33', '#00CC66', '#00CC99', '#00CCCC', '#00CCFF',\n  '#3300CC', '#3300FF', '#3333CC', '#3333FF', '#3366CC', '#3366FF', '#3399CC',\n  '#3399FF', '#33CC00', '#33CC33', '#33CC66', '#33CC99', '#33CCCC', '#33CCFF',\n  '#6600CC', '#6600FF', '#6633CC', '#6633FF', '#66CC00', '#66CC33', '#9900CC',\n  '#9900FF', '#9933CC', '#9933FF', '#99CC00', '#99CC33', '#CC0000', '#CC0033',\n  '#CC0066', '#CC0099', '#CC00CC', '#CC00FF', '#CC3300', '#CC3333', '#CC3366',\n  '#CC3399', '#CC33CC', '#CC33FF', '#CC6600', '#CC6633', '#CC9900', '#CC9933',\n  '#CCCC00', '#CCCC33', '#FF0000', '#FF0033', '#FF0066', '#FF0099', '#FF00CC',\n  '#FF00FF', '#FF3300', '#FF3333', '#FF3366', '#FF3399', '#FF33CC', '#FF33FF',\n  '#FF6600', '#FF6633', '#FF9900', '#FF9933', '#FFCC00', '#FFCC33'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\nfunction useColors() {\n  // NB: In an Electron preload script, document will be defined but not fully\n  // initialized. Since we know we're in Chrome, we'll just detect this case\n  // explicitly\n  if (typeof window !== 'undefined' && window.process && window.process.type === 'renderer') {\n    return true;\n  }\n\n  // Internet Explorer and Edge do not support colors.\n  if (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)) {\n    return false;\n  }\n\n  // is webkit? http://stackoverflow.com/a/16459606/376773\n  // document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n  return (typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance) ||\n    // is firebug? http://stackoverflow.com/a/398120/376773\n    (typeof window !== 'undefined' && window.console && (window.console.firebug || (window.console.exception && window.console.table))) ||\n    // is firefox >= v31?\n    // https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n    (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31) ||\n    // double check webkit in userAgent just in case we are in a worker\n    (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/));\n}\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nexports.formatters.j = function(v) {\n  try {\n    return JSON.stringify(v);\n  } catch (err) {\n    return '[UnexpectedJSONParseError]: ' + err.message;\n  }\n};\n\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n  var useColors = this.useColors;\n\n  args[0] = (useColors ? '%c' : '')\n    + this.namespace\n    + (useColors ? ' %c' : ' ')\n    + args[0]\n    + (useColors ? '%c ' : ' ')\n    + '+' + exports.humanize(this.diff);\n\n  if (!useColors) return;\n\n  var c = 'color: ' + this.color;\n  args.splice(1, 0, c, 'color: inherit')\n\n  // the final \"%c\" is somewhat tricky, because there could be other\n  // arguments passed either before or after the %c, so we need to\n  // figure out the correct index to insert the CSS into\n  var index = 0;\n  var lastC = 0;\n  args[0].replace(/%[a-zA-Z%]/g, function(match) {\n    if ('%%' === match) return;\n    index++;\n    if ('%c' === match) {\n      // we only are interested in the *last* %c\n      // (the user may have provided their own)\n      lastC = index;\n    }\n  });\n\n  args.splice(lastC, 0, c);\n}\n\n/**\n * Invokes `console.log()` when available.\n * No-op when `console.log` is not a \"function\".\n *\n * @api public\n */\n\nfunction log() {\n  // this hackery is required for IE8/9, where\n  // the `console.log` function doesn't have 'apply'\n  return 'object' === typeof console\n    && console.log\n    && Function.prototype.apply.call(console.log, console, arguments);\n}\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\n\nfunction save(namespaces) {\n  try {\n    if (null == namespaces) {\n      exports.storage.removeItem('debug');\n    } else {\n      exports.storage.debug = namespaces;\n    }\n  } catch(e) {}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\n\nfunction load() {\n  var r;\n  try {\n    r = exports.storage.debug;\n  } catch(e) {}\n\n  // If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n  if (!r && typeof process !== 'undefined' && 'env' in process) {\n    r = process.env.DEBUG;\n  }\n\n  return r;\n}\n\n/**\n * Enable namespaces listed in `localStorage.debug` initially.\n */\n\nexports.enable(load());\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage() {\n  try {\n    return window.localStorage;\n  } catch (e) {}\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/debug/src/browser.js\n// module id = 1\n// module chunks = 0","const CONTENT_TYPE_JSON = 27\nconst FIELDS_BY_PROTOCOL_VERSION =  {\n    '28': ['version', 'streamId', 'streamPartition', 'timestamp', 'ttl', 'offset', 'previousOffset', 'contentType', 'content']\n}\nconst MESSAGE_TYPES = ['b', 'u', 'subscribed', 'unsubscribed', 'resending', 'resent', 'no_resend']\nconst BYE_KEY = '_bye'\n\nexport function decodeBrowserWrapper(rawMsg) {\n    let jsonMsg = JSON.parse(rawMsg)\n    let version = jsonMsg[0]\n    if (version !== 0) {\n        throw 'Unknown message version: '+version\n    }\n\n    return {\n        type: MESSAGE_TYPES[jsonMsg[1]],\n        subId: jsonMsg[2],\n        msg: jsonMsg[3]\n    }\n}\n\nexport function decodeMessage(type, message) {\n    if (type === 'b' || type === 'u') {\n        if (FIELDS_BY_PROTOCOL_VERSION[message[0]] === undefined) {\n            throw 'Unsupported version: ' + message[0]\n        }\n        let result = {}\n        let fields = FIELDS_BY_PROTOCOL_VERSION[message[0]]\n\n        for (let i = 0; i < message.length; i++) {\n\n            // Parse content if necessary\n            if (fields[i] === 'content') {\n                if (result.contentType === CONTENT_TYPE_JSON) {\n                    message[i] = JSON.parse(message[i])\n                } else {\n                    throw 'Unknown content type: ' + result.contentType\n                }\n            }\n\n            result[fields[i]] = message[i]\n        }\n        return result\n    } else {\n        return message\n    }\n}\n\nexport function createSubscribeRequest(stream, resendOptions) {\n    let req = {\n        stream: stream\n    }\n    Object.keys(resendOptions).forEach(function(key) {\n        req[key] = resendOptions[key]\n    })\n    return req\n}\n\nexport function isByeMessage(message) {\n    return !!message[BYE_KEY]\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/Protocol.js","const WebSocket = typeof window !== 'undefined' ? window.WebSocket : require('ws')\nmodule.exports = WebSocket\n\n\n\n// WEBPACK FOOTER //\n// ./src/shims/ws.js","import StreamrClient from './StreamrClient'\n//import Subscription from './Subscription'\n//import Connection from './Connection'\n//import * as Protocol from './Protocol'\n\nexport default StreamrClient\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import EventEmitter from 'eventemitter3'\nimport debug from 'debug'\n\nimport Subscription from './Subscription'\nimport Connection from './Connection'\n\nexport default class StreamrClient extends EventEmitter {\n\n    constructor(options) {\n        super()\n\n        // Default options\n        this.options = {\n            // The server to connect to\n            url: 'wss://www.streamr.com/api/v1/ws',\n            // Automatically connect on first subscribe\n            autoConnect: true,\n            // Automatically disconnect on last unsubscribe\n            autoDisconnect: true,\n            authKey: null\n        }\n        this.subsByStream = {}\n        this.subById = {}\n\n        this.connection = null\n        this.connected = false\n\n        Object.assign(this.options, options || {})\n    }\n\n    _addSubscription(sub) {\n        this.subById[sub.id] = sub\n\n        if (!this.subsByStream[sub.streamId]) {\n            this.subsByStream[sub.streamId] = [sub]\n        } else {\n            this.subsByStream[sub.streamId].push(sub)\n        }\n    }\n\n    _removeSubscription(sub) {\n        delete this.subById[sub.id]\n\n        if (this.subsByStream[sub.streamId]) {\n            this.subsByStream[sub.streamId] = this.subsByStream[sub.streamId].filter((it) => {\n                return it !== sub\n            })\n\n            if (this.subsByStream[sub.streamId].length === 0) {\n                delete this.subsByStream[sub.streamId]\n            }\n        }\n    }\n\n    getSubscriptions(streamId) {\n        return this.subsByStream[streamId] || []\n    }\n\n    subscribe(options, callback, legacyOptions) {\n        if (!options) {\n            throw 'subscribe: Invalid arguments: subscription options is required!'\n        } else if (!callback) {\n            throw 'subscribe: Invalid arguments: callback is required!'\n        }\n\n        // Backwards compatibility for giving a streamId as first argument\n        if (typeof options === 'string') {\n            options = {\n                stream: options\n            }\n        } else if (typeof options !== 'object') {\n            throw 'subscribe: options must be an object'\n        }\n\n        // Backwards compatibility for giving an options object as third argument\n        Object.assign(options, legacyOptions)\n\n        if (!options.stream) {\n            throw 'subscribe: Invalid arguments: options.stream is not given'\n        }\n\n        // Create the Subscription object and bind handlers\n        let sub = new Subscription(options.stream, options.partition || 0, options.authKey || this.options.authKey, callback, options)\n        sub.on('gap', (from, to) => {\n            this._requestResend(sub, {\n                resend_from: from, resend_to: to\n            })\n        })\n        sub.on('done', () => {\n            debug('done event for sub %d', sub.id)\n            this.unsubscribe(sub)\n        })\n\n        // Add to lookups\n        this._addSubscription(sub)\n\n        // If connected, emit a subscribe request\n        if (this.connected) {\n            this._resendAndSubscribe(sub)\n        } else if (this.options.autoConnect) {\n            this.connect()\n        }\n\n        return sub\n    }\n\n    unsubscribe(sub) {\n        if (!sub || !sub.streamId) {\n            throw 'unsubscribe: please give a Subscription object as an argument!'\n        }\n\n        // If this is the last subscription for this stream, unsubscribe the client too\n        if (this.subsByStream[sub.streamId] !== undefined && this.subsByStream[sub.streamId].length === 1 && this.connected && !this.disconnecting && sub.isSubscribed() && !sub.unsubscribing) {\n            sub.unsubscribing = true\n            this._requestUnsubscribe(sub.streamId)\n        } else if (!sub.unsubscribing) {\n            // Else the sub can be cleaned off immediately\n            this._removeSubscription(sub)\n            sub.emit('unsubscribed')\n            this._checkAutoDisconnect()\n        }\n    }\n\n    unsubscribeAll(streamId) {\n        if (!streamId) {\n            throw 'unsubscribeAll: a stream id is required!'\n        } else if (typeof streamId !== 'string') {\n            throw 'unsubscribe: stream id must be a string!'\n        }\n\n        if (this.subsByStream[streamId]) {\n            // Copy the list to avoid concurrent modifications\n            let l = this.subsByStream[streamId].slice()\n            l.forEach((sub) => {\n                this.unsubscribe(sub)\n            })\n        }\n    }\n\n    isConnected() {\n        return this.connected\n    }\n\n    reconnect() {\n        return this.connect(true)\n    }\n\n    connect() {\n        if (this.connected) {\n            debug('connect() called while already connected, doing nothing...')\n            return\n        } else if (this.connecting) {\n            debug('connect() called while connecting, doing nothing...')\n            return\n        }\n\n        debug('Connecting to %s', this.options.url)\n        this.connecting = true\n        this.disconnecting = false\n\n        this.connection = new Connection(this.options)\n\n        // Broadcast messages to all subs listening on stream\n        this.connection.on('b', (msg) => {\n            // Notify the Subscriptions for this stream. If this is not the message each individual Subscription\n            // is expecting, they will either ignore it or request resend via gap event.\n            let streamId = msg.streamId\n            let subs = this.subsByStream[streamId]\n            if (subs) {\n                for (let i = 0; i < subs.length; i++) {\n                    subs[i].handleMessage(msg, false)\n                }\n            } else {\n                debug('WARN: message received for stream with no subscriptions: %s', streamId)\n            }\n        })\n\n        // Unicast messages to a specific subscription only\n        this.connection.on('u', (msg, sub) => {\n            if (sub !== undefined && this.subById[sub] !== undefined) {\n                this.subById[sub].handleMessage(msg, true)\n            } else {\n                debug('WARN: subscription not found for stream: %s, sub: %s', msg.streamId, sub)\n            }\n        })\n\n        this.connection.on('subscribed', (response) => {\n            if (response.error) {\n                this.handleError('Error subscribing to ' + response.stream + ': ' + response.error)\n            } else {\n                let subs = this.subsByStream[response.stream]\n                delete subs._subscribing\n\n                debug('Client subscribed: %o', response)\n\n                // Report subscribed to all non-resending Subscriptions for this stream\n                subs.filter((sub) => {\n                    return !sub.resending\n                })\n                    .forEach((sub) => {\n                        sub.emit('subscribed')\n                    })\n            }\n        })\n\n        this.connection.on('unsubscribed', (response) => {\n            debug('Client unsubscribed: %o', response)\n\n            if (this.subsByStream[response.stream]) {\n                // Copy the list to avoid concurrent modifications\n                let l = this.subsByStream[response.stream].slice()\n                l.forEach((sub) => {\n                    this._removeSubscription(sub)\n                    sub.emit('unsubscribed')\n                })\n            }\n\n            this._checkAutoDisconnect()\n        })\n\n        // Route resending state messages to corresponding Subscriptions\n        this.connection.on('resending', (response) => {\n            if (this.subById[response.sub]) {\n                this.subById[response.sub].emit('resending', response)\n            } else {\n                debug('resent: Subscription %d is gone already', response.sub)\n            }\n        })\n\n        this.connection.on('no_resend', (response) => {\n            if (this.subById[response.sub]) {\n                this.subById[response.sub].emit('no_resend', response)\n            } else {\n                debug('resent: Subscription %d is gone already', response.sub)\n            }\n        })\n\n        this.connection.on('resent', (response) => {\n            if (this.subById[response.sub]) {\n                this.subById[response.sub].emit('resent', response)\n            } else {\n                debug('resent: Subscription %d is gone already', response.sub)\n            }\n        })\n\n        // On connect/reconnect, send pending subscription requests\n        this.connection.on('connected', () => {\n            debug('Connected!')\n            this.connected = true\n            this.connecting = false\n            this.disconnecting = false\n            this.emit('connected')\n\n            Object.keys(this.subsByStream)\n                .forEach((streamId) => {\n                    let subs = this.subsByStream[streamId]\n                    subs.forEach((sub) => {\n                        if (!sub.isSubscribed()) {\n                            this._resendAndSubscribe(sub)\n                        }\n                    })\n                })\n        })\n\n        this.connection.on('disconnected', () => {\n            debug('Disconnected.')\n            this.connected = false\n            this.connecting = false\n            this.disconnecting = false\n            this.emit('disconnected')\n\n            Object.keys(this.subsByStream)\n                .forEach((streamId) => {\n                    let subs = this.subsByStream[streamId]\n                    delete subs._subscribing\n                    subs.forEach((sub) => {\n                        sub.emit('disconnected')\n                    })\n                })\n        })\n\n        this.connection.connect() // TODO: i did not find this anywhere else?\n        return this.subsByStream\n    }\n\n    pause() {\n        this.connection.disconnect()\n    }\n\n    disconnect() {\n        this.connecting = false\n        this.disconnecting = true\n\n        Object.keys(this.subsByStream)\n            .forEach((streamId) => {\n                this.unsubscribeAll(streamId)\n            })\n\n        this.connection.disconnect()\n    }\n\n    _checkAutoDisconnect() {\n        // Disconnect if no longer subscribed to any streams\n        if (this.options.autoDisconnect && Object.keys(this.subsByStream).length === 0) {\n            debug('Disconnecting due to no longer being subscribed to any streams')\n            this.disconnect()\n        }\n    }\n\n    _resendAndSubscribe(sub) {\n        if (!sub.subscribing && !sub.resending) {\n            sub.subscribing = true\n            this._requestSubscribe(sub)\n\n            // Once subscribed, ask for a resend\n            sub.once('subscribed', () => {\n                if (sub.hasResendOptions()) {\n                    this._requestResend(sub)\n                }\n            })\n        }\n    }\n\n    _requestSubscribe(sub) {\n        let subs = this.subsByStream[sub.streamId]\n\n        let subscribedSubs = subs.filter((it) => {\n            return it.isSubscribed()\n        })\n\n        // If this is the first subscription for this stream, send a subscription request to the server\n        if (!subs._subscribing && subscribedSubs.length === 0) {\n            let req = Object.assign({}, sub.options, {\n                type: 'subscribe', stream: sub.streamId, authKey: sub.authKey\n            })\n            debug('_requestSubscribe: subscribing client: %o', req)\n            subs._subscribing = true\n            this.connection.send(req)\n        } else if (subscribedSubs.length > 0) {\n            // If there already is a subscribed subscription for this stream, this new one will just join it immediately\n            debug('_requestSubscribe: another subscription for same stream: %s, insta-subscribing', sub.streamId)\n\n            setTimeout(() => {\n                sub.emit('subscribed')\n            }, 0)\n        }\n    }\n\n    _requestUnsubscribe(streamId) {\n        debug('Client unsubscribing stream %o', streamId)\n        this.connection.send({\n            type: 'unsubscribe',\n            stream: streamId\n        })\n    }\n\n    _requestResend(sub, resendOptions) {\n        // If overriding resendOptions are given, need to remove resend options in sub.options\n        let options = Object.assign({}, sub.getEffectiveResendOptions())\n        if (resendOptions) {\n            Object.keys(options)\n                .forEach((key) => {\n                    if (key.match(/resend_.*/)) {\n                        delete options[key]\n                    }\n                })\n        }\n\n        sub.resending = true\n\n        let request = Object.assign({}, options, resendOptions, {\n            type: 'resend', stream: sub.streamId, partition: sub.streamPartition, authKey: sub.authKey, sub: sub.id\n        })\n        debug('_requestResend: %o', request)\n        this.connection.send(request)\n    }\n\n    handleError(msg) {\n        debug(msg)\n        this.emit('error', msg)\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/StreamrClient.js","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/process/browser.js\n// module id = 6\n// module chunks = 0","\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = createDebug.debug = createDebug['default'] = createDebug;\nexports.coerce = coerce;\nexports.disable = disable;\nexports.enable = enable;\nexports.enabled = enabled;\nexports.humanize = require('ms');\n\n/**\n * Active `debug` instances.\n */\nexports.instances = [];\n\n/**\n * The currently active debug mode names, and names to skip.\n */\n\nexports.names = [];\nexports.skips = [];\n\n/**\n * Map of special \"%n\" handling functions, for the debug \"format\" argument.\n *\n * Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n */\n\nexports.formatters = {};\n\n/**\n * Select a color.\n * @param {String} namespace\n * @return {Number}\n * @api private\n */\n\nfunction selectColor(namespace) {\n  var hash = 0, i;\n\n  for (i in namespace) {\n    hash  = ((hash << 5) - hash) + namespace.charCodeAt(i);\n    hash |= 0; // Convert to 32bit integer\n  }\n\n  return exports.colors[Math.abs(hash) % exports.colors.length];\n}\n\n/**\n * Create a debugger with the given `namespace`.\n *\n * @param {String} namespace\n * @return {Function}\n * @api public\n */\n\nfunction createDebug(namespace) {\n\n  var prevTime;\n\n  function debug() {\n    // disabled?\n    if (!debug.enabled) return;\n\n    var self = debug;\n\n    // set `diff` timestamp\n    var curr = +new Date();\n    var ms = curr - (prevTime || curr);\n    self.diff = ms;\n    self.prev = prevTime;\n    self.curr = curr;\n    prevTime = curr;\n\n    // turn the `arguments` into a proper Array\n    var args = new Array(arguments.length);\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i];\n    }\n\n    args[0] = exports.coerce(args[0]);\n\n    if ('string' !== typeof args[0]) {\n      // anything else let's inspect with %O\n      args.unshift('%O');\n    }\n\n    // apply any `formatters` transformations\n    var index = 0;\n    args[0] = args[0].replace(/%([a-zA-Z%])/g, function(match, format) {\n      // if we encounter an escaped % then don't increase the array index\n      if (match === '%%') return match;\n      index++;\n      var formatter = exports.formatters[format];\n      if ('function' === typeof formatter) {\n        var val = args[index];\n        match = formatter.call(self, val);\n\n        // now we need to remove `args[index]` since it's inlined in the `format`\n        args.splice(index, 1);\n        index--;\n      }\n      return match;\n    });\n\n    // apply env-specific formatting (colors, etc.)\n    exports.formatArgs.call(self, args);\n\n    var logFn = debug.log || exports.log || console.log.bind(console);\n    logFn.apply(self, args);\n  }\n\n  debug.namespace = namespace;\n  debug.enabled = exports.enabled(namespace);\n  debug.useColors = exports.useColors();\n  debug.color = selectColor(namespace);\n  debug.destroy = destroy;\n\n  // env-specific initialization logic for debug instances\n  if ('function' === typeof exports.init) {\n    exports.init(debug);\n  }\n\n  exports.instances.push(debug);\n\n  return debug;\n}\n\nfunction destroy () {\n  var index = exports.instances.indexOf(this);\n  if (index !== -1) {\n    exports.instances.splice(index, 1);\n    return true;\n  } else {\n    return false;\n  }\n}\n\n/**\n * Enables a debug mode by namespaces. This can include modes\n * separated by a colon and wildcards.\n *\n * @param {String} namespaces\n * @api public\n */\n\nfunction enable(namespaces) {\n  exports.save(namespaces);\n\n  exports.names = [];\n  exports.skips = [];\n\n  var i;\n  var split = (typeof namespaces === 'string' ? namespaces : '').split(/[\\s,]+/);\n  var len = split.length;\n\n  for (i = 0; i < len; i++) {\n    if (!split[i]) continue; // ignore empty strings\n    namespaces = split[i].replace(/\\*/g, '.*?');\n    if (namespaces[0] === '-') {\n      exports.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n    } else {\n      exports.names.push(new RegExp('^' + namespaces + '$'));\n    }\n  }\n\n  for (i = 0; i < exports.instances.length; i++) {\n    var instance = exports.instances[i];\n    instance.enabled = exports.enabled(instance.namespace);\n  }\n}\n\n/**\n * Disable debug output.\n *\n * @api public\n */\n\nfunction disable() {\n  exports.enable('');\n}\n\n/**\n * Returns true if the given mode name is enabled, false otherwise.\n *\n * @param {String} name\n * @return {Boolean}\n * @api public\n */\n\nfunction enabled(name) {\n  if (name[name.length - 1] === '*') {\n    return true;\n  }\n  var i, len;\n  for (i = 0, len = exports.skips.length; i < len; i++) {\n    if (exports.skips[i].test(name)) {\n      return false;\n    }\n  }\n  for (i = 0, len = exports.names.length; i < len; i++) {\n    if (exports.names[i].test(name)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Coerce `val`.\n *\n * @param {Mixed} val\n * @return {Mixed}\n * @api private\n */\n\nfunction coerce(val) {\n  if (val instanceof Error) return val.stack || val.message;\n  return val;\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/debug/src/debug.js\n// module id = 7\n// module chunks = 0","/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isNaN(val) === false) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^((?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  if (ms >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (ms >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (ms >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (ms >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  return plural(ms, d, 'day') ||\n    plural(ms, h, 'hour') ||\n    plural(ms, m, 'minute') ||\n    plural(ms, s, 'second') ||\n    ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, n, name) {\n  if (ms < n) {\n    return;\n  }\n  if (ms < n * 1.5) {\n    return Math.floor(ms / n) + ' ' + name;\n  }\n  return Math.ceil(ms / n) + ' ' + name + 's';\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/ms/index.js\n// module id = 8\n// module chunks = 0","import EventEmitter from 'eventemitter3'\nimport debug from 'debug'\n\nimport {isByeMessage} from './Protocol'\n\nlet subId = 0\nfunction generateSubscriptionId() {\n    let id = subId++\n    return id.toString()\n}\n\nexport default class Subscription extends EventEmitter {\n\n    constructor(streamId, streamPartition, authKey, callback, options) {\n        super()\n\n        if (!streamId) {\n            throw 'No stream id given!'\n        }\n        if (!callback) {\n            throw 'No callback given!'\n        }\n\n        this.id = generateSubscriptionId()\n        this.streamId = streamId\n        this.streamPartition = streamPartition\n        this.authKey = authKey\n        this.callback = callback\n        this.options = options || {}\n        this.queue = []\n        this.subscribing = false\n        this.subscribed = false\n        this.lastReceivedOffset = null\n\n        // Check that multiple resend options are not given\n        let resendOptionCount = 0\n        if (this.options.resend_all) {\n            resendOptionCount++\n        }\n        if (this.options.resend_from != null) {\n            resendOptionCount++\n        }\n        if (this.options.resend_last != null) {\n            resendOptionCount++\n        }\n        if (this.options.resend_from_time != null) {\n            resendOptionCount++\n        }\n        if (resendOptionCount > 1) {\n            throw 'Multiple resend options active! Please use only one: ' + JSON.stringify(options)\n        }\n\n        // Automatically convert Date objects to numbers for resend_from_time\n        if (this.options.resend_from_time != null\n            && typeof this.options.resend_from_time !== 'number') {\n\n            if (typeof this.options.resend_from_time.getTime === 'function') {\n                this.options.resend_from_time = this.options.resend_from_time.getTime()\n            } else {\n                throw 'resend_from_time option must be a Date object or a number representing time!'\n            }\n        }\n\n        /*** Message handlers ***/\n\n        this.on('subscribed', () => {\n            debug('Sub %s subscribed to stream: %s', this.id, this.streamId)\n            this.subscribed = true\n            this.subscribing = false\n        })\n\n        this.on('unsubscribed', () => {\n            debug('Sub %s unsubscribed: %s', this.id, this.streamId)\n            this.subscribed = false\n            this.subscribing = false\n            this.unsubscribing = false\n            this.resending = false\n        })\n\n        this.on('resending', (response) => {\n            debug('Sub %s resending: %o', this.id, response)\n            // this.resending = true was set elsewhere before making the request\n        })\n\n        this.on('no_resend', (response) => {\n            debug('Sub %s no_resend: %o', this.id, response)\n            this.resending = false\n            this.checkQueue()\n        })\n\n        this.on('resent', (response) => {\n            debug('Sub %s resent: %o', this.id, response)\n            this.resending = false\n            this.checkQueue()\n        })\n\n        this.on('connected', () => {\n\n        })\n\n        this.on('disconnected', () => {\n            this.subscribed = false\n            this.subscribing = false\n            this.resending = false\n        })\n    }\n\n    handleMessage(msg, isResend) {\n        let content = msg.content\n        let offset = msg.offset\n        let previousOffset = msg.previousOffset\n\n        if (previousOffset == null) {\n            debug('handleMessage: prevOffset is null, gap detection is impossible! message: %o', msg)\n        }\n\n        // TODO: check this.options.resend_last ?\n        // If resending, queue broadcasted messages\n        if (this.resending && !isResend) {\n            this.queue.push(msg)\n        } else {\n            // Gap check\n            if (previousOffset != null && \t\t\t\t\t// previousOffset is required to check for gaps\n                this.lastReceivedOffset != null &&  \t\t// and we need to know what msg was the previous one\n                previousOffset > this.lastReceivedOffset &&\t// previous message had larger offset than our previous msg => gap!\n                !this.resending) {\n\n                // Queue the message to be processed after resend\n                this.queue.push(msg)\n\n                let from = this.lastReceivedOffset + 1\n                let to = previousOffset\n                debug('Gap detected, requesting resend for stream %s from %d to %d', this.streamId, from, to)\n                this.emit('gap', from, to)\n            } else if (this.lastReceivedOffset != null && offset <= this.lastReceivedOffset) {\n                // Prevent double-processing of messages for any reason\n                debug('Sub %s already received message: %d, lastReceivedOffset: %d. Ignoring message.', this.id, offset, this.lastReceivedOffset)\n            } else {\n                // Normal case where prevOffset == null || lastReceivedOffset == null || prevOffset === lastReceivedOffset\n                this.lastReceivedOffset = offset\n                this.callback(content, msg)\n                if (isByeMessage(content)) {\n                    this.emit('done')\n                }\n            }\n        }\n    }\n\n    checkQueue() {\n        if (this.queue.length) {\n            debug('Attempting to process %d queued messages for stream %s', this.queue.length, this.streamId)\n\n            let i\n            let length = this.queue.length\n\n            let originalQueue = this.queue\n            this.queue = []\n\n            for (i = 0; i < length; i++) {\n                let msg = originalQueue[i]\n                this.handleMessage(msg, false)\n            }\n        }\n    }\n\n    hasResendOptions() {\n        return this.options.resend_all === true || this.options.resend_from >= 0 || this.options.resend_from_time >= 0 || this.options.resend_last > 0\n    }\n\n    /**\n     * Resend needs can change if messages have already been received.\n     * This function always returns the effective resend options:\n     *\n     * If messages have been received:\n     * - resend_all becomes resend_from\n     * - resend_from becomes resend_from the latest received message\n     * - resend_from_time becomes resend_from the latest received message\n     * - resend_last stays the same\n     */\n    getEffectiveResendOptions() {\n        if (this.hasReceivedMessages() && this.hasResendOptions()) {\n            if (this.options.resend_all || this.options.resend_from || this.options.resend_from_time) {\n                return {\n                    resend_from: this.lastReceivedOffset + 1\n                }\n            } else if (this.options.resend_last) {\n                return this.options\n            }\n        } else {\n            return this.options\n        }\n    }\n\n    hasReceivedMessages() {\n        return this.lastReceivedOffset != null\n    }\n\n    isSubscribed() {\n        return this.subscribed\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/Subscription.js","import EventEmitter from 'eventemitter3'\nimport debug from 'debug'\nimport WebSocket from 'ws'\n\nimport {decodeBrowserWrapper, decodeMessage} from './Protocol'\n\nexport default class Connection extends EventEmitter {\n    constructor(options) {\n        super()\n        if (!options.url) {\n            throw 'URL is not defined!'\n        }\n        this.options = options\n        this.connected = false\n        this.connecting = false\n        this.disconnecting = false\n\n        if (options.autoConnect) {\n            this.connect()\n        }\n    }\n\n    connect() {\n        if (!(this.connected || this.connecting)) {\n            this.connecting = true\n\n            this.socket = new WebSocket(this.options.url)\n            this.socket.binaryType = 'arraybuffer'\n            this.emit('connecting')\n\n            this.socket.onopen = () => {\n                debug('Connected to ', this.options.url)\n                this.connected = true\n                this.connecting = false\n                this.emit('connected')\n            }\n\n            this.socket.onclose = () => {\n                if (!this.disconnecting) {\n                    debug('Connection lost. Attempting to reconnect')\n                    setTimeout(() => {\n                        this.connect()\n                    }, 2000)\n                } else {\n                    this.disconnecting = false\n                }\n\n                this.connected = false\n                this.connecting = false\n                this.emit('disconnected')\n            }\n\n            this.socket.onmessage = (messageEvent) => {\n                let decoded = decodeBrowserWrapper(messageEvent.data)\n                this.emit(decoded.type, decodeMessage(decoded.type, decoded.msg), decoded.subId)\n            }\n        }\n    }\n\n    disconnect() {\n        if (this.socket !== undefined && (this.connected || this.connecting)) {\n            this.disconnecting = true\n            this.socket.close()\n        }\n    }\n\n    send(req) {\n        this.socket.send(JSON.stringify(req))\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/Connection.js"],"sourceRoot":""}